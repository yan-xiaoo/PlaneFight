# 飞机大战

> 作者：liyanxiao050804@126.com
>
> 游戏与文档均由本人一人完成

本游戏为西安交大小学期的学期汇报作业。

- [飞机大战](#飞机大战)
  - [游戏简介](#游戏简介)
  - [游戏操作](#游戏操作)
  - [游戏设置](#游戏设置)
    - [怎么表示我想要的按键？](#怎么表示我想要的按键)
  - [游戏数值](#游戏数值)
    - [玩家](#玩家)
    - [普通敌方](#普通敌方)
    - [Boss飞机](#boss飞机)
  - [游戏难度设置与敌机技能](#游戏难度设置与敌机技能)
    - [分数与隐藏难度](#分数与隐藏难度)
    - [Boss技能](#boss技能)



## 游戏简介

和绝大部分的飞机游戏一样，本游戏中会不断出现小型敌方飞机。击败敌方飞机，得到超过350分后，Boss敌机将会出现。击败Boss敌机即可获得游戏的胜利。被敌方飞机撞到或被敌方子弹击中会失败。

![image-20230628133703318](/Users/liyanxiao/PycharmProjects/SmallTermGame/README.assets/image-20230628133703318.png)

游戏在进入Boss战后会随时自动保存。玩家在Boss战中死亡，选择重玩后，将直接进入Boss战，且Boss血量与玩家得分继承被击败前的进度。

玩家如果在进入Boss战前失败，则得分不会继承，需要从头开始游戏。

胜利后选择重玩，也将重新开始游戏。

## 游戏操作

> 以下提到的所有键盘按键全部可以在configure.py里修改（如果用的是打包版就改不了），鼠标按键不能改

- 玩家射击：空格或鼠标左键

- 玩家移动：WASD键或上下左右方向键

- 暂停游戏：E键

- 显示帧率：Q键

- 玩家发射追踪弹：C键或鼠标右键

  > 追踪弹仅在Boss战中可用。追踪弹被发射后，会持续追踪Boss直至命中，对Boss造成50点伤害

- 按下b,u,g三个按键（不用同时按，各按一次即可）可以触发Bug，让你不受伤害

  > 这样就算打不过也不用找修改器了	
  >
  > 这个开挂模式下存在个问题，就是你直接撞到Boss身上的话会因为两者都不会马上死掉而每帧产生一次爆炸，每次爆炸对Boss造成10点伤害，在一秒内把Boss干掉

建议操作方法：左手操作WASD与E，Q键，右手使用鼠标控制射击与追踪弹的发射，这样两只手都只需要管一小部分区域

长按空格/鼠标左键可以连射（玩家飞机以最大速度持续发射子弹），不需要一直狂按按键。

玩家死亡后图中的"Replay"是可以点的（虽然我没做点击特效），点击后可以重新开始游戏

![image-20230628142203639](/Users/liyanxiao/PycharmProjects/SmallTermGame/README.assets/image-20230628142203639.png)

## 游戏设置

> 只有运行源码的时候能修改设置，运行打包完的程序时改不了

游戏操作中的键盘按键都可以在configure.py中修改。此外，以下内容也可以在configure.py里修改：

- 帧率上限：设置 `MAX_RATE = `后面的数字为你想要的即可，默认锁120帧。改为`None`即可取消帧率锁定。

  > 游戏中所有的计算都与帧率无关，请放心修改

- 退出按键：除了点游戏界面标题栏的叉号能退出之外，按下ESC也可以退出游戏。

  修改：设置`QUIT_KEY = `后面的内容为你想要的按键即可。怎么表示按键看下面：

### 怎么表示我想要的按键？

对于26个字母和10个数字按键，pygame中的按键名称为`pygame.K_x`，x表示那个键的名字。例如：

K键: `pygame.K_k`

0键：`pygame.K_0`

请注意`K_x`中前面的K必须为大写， 后面的x（按键名）必须为小写。

要修改为其他按键，请上网搜索“pygame中的xx键名称是什么？“

## 游戏数值

### 玩家

玩家只有1点血，被任何敌方子弹类物体打到或被敌机撞到就会死

玩家攻击发射的子弹每颗伤害为1点。在Boss战外，玩家攻击间隔为0.25s（一秒四颗）。Boss战内，玩家的攻击间隔为0.05s（帧率大于20时一秒二十颗）

玩家在Boss战内可以发射追踪弹。追踪弹表现为一个小火球，会持续追踪Boss，在命中时造成50点伤害。玩家发射追踪弹的间隔为5秒

![image-20230628140822836](/Users/liyanxiao/PycharmProjects/SmallTermGame/README.assets/image-20230628140822836.png)

> 上方图中的火球就是追踪弹

### 普通敌方

普通敌机也只有1点血，被我方子弹或者我方撞到就会死。

通过任何方式产生的爆炸也会干掉敌机。这是故意设计的，用于引发“连锁爆炸”。当几架敌机在生成时相互重叠时，我方击中一架飞机即可引发连锁爆炸，干掉重叠的所有敌机

### Boss飞机

Boss拥有1000血量。玩家在Boss战中每死亡一次，Boss恢复25点血量，最高恢复至满血。Boss的任何攻击击中玩家均会令玩家死亡。

Boss与玩家碰撞时，玩家立刻死亡（没开Bug模式的情况下），Boss扣除10点血量。

Boss每被玩家的一颗子弹击中扣除1点血量。被玩家追踪弹击中扣除50点血量

> 游戏上方血条显示的是Boss当前血量相对于Boss满血量的百分比



## 游戏难度设置与敌机技能

<font color=red>如果你希望自己探索Boss的技能与游戏设置的话，不要看这一部分。</font>

防剧透

防剧透

防剧透

防剧透

防剧透



### 分数与隐藏难度

游戏中有隐藏的四个难度等级，以玩家的得分为基准来确定目前的难度。

击败一架敌机固定获得10分，不受难度影响。分数大于等于350分后进入Boss战，生成Boss，不再生成普通敌机

击败Boss固定获得200分。

| 难度 | 分数    | 一批出现敌机数量 | 敌机速度（像素/秒） | 是否可发弹 | 子弹是否可追踪  |
| ---- | ------- | ---------------- | ------------------- | ---------- | --------------- |
| 0    | 0-100   | 1-3              | 150-200             | 否         | 否              |
| 1    | 100-200 | 2-4              | 175-225             | 否         | 否              |
| 2    | 200-300 | 2-5              | 175-250             | 是         | 否              |
| 3    | 300-350 | 3-5              | 175-250             | 是         | 是（持续追踪1s) |

以上内容在游戏中规定在main.py的常量字典DIFFICULTY里头

### Boss技能

Boss在游戏中只会水平移动，不会竖直动。每帧固定向一侧移动100～200像素，在到达一侧边缘后变为持续向另一侧移动。

Boss一共有六个技能：

- 追踪弹：发射3颗速度为300像素/秒，持续追踪我方1.5秒的子弹

- 火球：以自身为中心，每隔20度发射一颗速度为300像素每秒的火球。方向在发射时固定。

- 超级扫射：在1.25秒内，每50毫秒发射三颗速度为300像素/秒的子弹，共发射25*3=75颗。每次发射的三颗子弹会在发射瞬间锁定我方当时的位置，然后持续向该方向飞行，不再追踪。

- 普通攻击：在7.5秒内，每0.75秒向自身正前方发射一颗速度为300像素/秒的子弹，不追踪

- 超级巨型大火球：发射一个碰撞体积为100像素x100像素的超大的火球。

  火球会先在Boss头部随Boss移动1.5秒，给玩家预警时间。火球在离开Boss的瞬间，会锁定我方的位置，并持续向该方向以0像素/秒的初速度，500像素/秒的加速度飞行。火球不持续追踪我方。

  > 个人感觉这几乎是最好躲的技能，火球虽然加速度高但没有初速度，总体不快，还有很长的预警时间，唯一的难点是火球碰撞体积有点大

- 拉帮结派：在（50，100），（590，100）两处固定位置召唤两架无敌的敌方飞机，持续15秒后飞机自动退场。这两架飞机存在期间，每1秒向其正前方发射一颗速度为300像素/秒的子弹，不追踪。

  > 这个应该是最好躲的，只要不到这两架小飞机面前就行。需要小心的反而是Boss在这俩飞机存在期间释放的其他攻击

**技能cd**

| 技能名         | 初始cd（秒） | 每次cd（秒） | 持续（秒）   |
| -------------- | ------------ | ------------ | ------------ |
| 追踪弹         | 15           | 15           | 瞬间发射完成 |
| 火球           | 10           | 10           | 瞬间发射完成 |
| 超级扫射       | 10           | 10           | 1.25         |
| 普通攻击       | 12.5         | 12.5         | 7.5          |
| 超级巨型大火球 | 5            | 10           | 1.5+         |
| 拉帮结派       | 17           | 17           | 15           |

>初始cd: Boss出现时，第一次释放该技能需要的冷却时间
>
>每次cd:Boss释放过该技能后，再次释放需要间隔的时间

Boss拥有共用技能cd5秒。即：Boss释放一个技能后，无论其他技能是否完成冷却，都必须隔至少5秒才能释放其他技能

Boss释放的技能是随机选择的。算法：

每一帧，检查所有冷却完成的技能。如果存在冷却完成的技能，且共用技能cd完成冷却，那么有10%的概率释放技能。释放的技能从完成了冷却的技能里随机选择一个。成功释放技能后，该技能立刻进入cd（不管它持续多久），共用技能cd立刻进入冷却。

游戏采用多线程模块，每一个技能释放后都在单独的线程上运行，不受影响。因此，在持续时间大于5秒的技能生效期间（普通攻击，拉帮结派），Boss可能还会同时释放其他技能。